<!DOCTYPE html>
<html lang="en" translate="no">

<head>
  <meta charset="utf-8" />
  <meta name="google" content="notranslate" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>swaplist.app (local)</title>

  <link rel="icon" type="image/png" href="https://swaplist.app/dat/favicon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/svg+xml" href="https://swaplist.app/dat/favicon/favicon.svg">
  <link rel="shortcut icon" href="https://swaplist.app/dat/favicon/favicon.ico" sizes="16x16 32x32 48x48 64x64">
  <link rel="apple-touch-icon" sizes="180x180" href="https://swaplist.app/dat/favicon/apple-touch-icon.png">
  <link rel="manifest" href="https://swaplist.app/dat/favicon/site.webmanifest">

  <!-- Styles -->
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>

<body class="notranslate" translate="no">
  <input type="checkbox" class="hidden" id="debug_outline" />
  <div id="app_wrapper">
    <div id="app_header">
      <div>
        <img id="logo" src="assets/img/logo_swaplist_app.png" height="42" alt="swaplist logo">
        <div id="statistics" class="hidden">
          <div id="queue_statistics">
            <h3>Queue statistics:</h3>
            <div>
              <span> Duration: </span>
              <span id="total_time"> 19m 12s </span>
            </div>
            <div>
              <span> Plates: </span>
              <span id="used_plates"> 3 </span>
            </div>
          </div>
          <div id="filament_statistics">
            <h3>Filament usage statistics:</h3>
            <div id="filament_total">
              <div title="1">Slot 1: <br> 0.08m <br> 0.23g</div>
              <div title="2">Slot 2: <br> 0.08m <br> 0.23g</div>
              <div title="3">Slot 3: <br> 0.08m <br> 0.23g</div>
              <div title="4">Slot 4: <br> 0.08m <br> 0.23g</div>
            </div>
          </div>
        </div>
      </div>
      <div>
        <div id="action_buttons" class="hidden">
          <!-- 1) Mode-Toggle: erscheint zusammen mit action_buttons -->
          <div id="mode_switch" class="mode-toggle hidden">
            <input type="radio" id="mode_a1m" name="mode" value="A1M" checked>
            <label for="mode_a1m">A1&nbsp;Mini</label>

            <input type="radio" id="mode_x1" name="mode" value="X1">
            <label for="mode_x1">X1</label>

            <input type="radio" id="mode_p1" name="mode" value="P1">
            <label for="mode_p1">P1</label>
          </div>

          <!-- 2) Generate + Progressbar -->
          <button id="export">Generate SWAP file</button>

          <button id="export_gcode">Export GCODE</button>
          <!-- 3) Reset ganz unten -->
          <button id="reset">Reset</button>
          <div id="progress_bar" style="opacity: 0; width: 100%;">
            <div id="progress_scale" style="width: 0%; display: flex;"> </div>
          </div>

          <button id="btn_compare_settings" class="btn btn-secondary" type="button"
            title="Vergleicht original vs. modifiziertes project_settings und loggt Unterschiede in die Konsole">
            Compare project_settings
          </button>

          <input autocomplete="off" type="checkbox" id="show_settings" name="show_settings">
          <label for="show_settings"> Show settings </label>
        </div>
      </div>
    </div>

    <div id="app_content">
      <div id="plates_wrapper">
        <div id="drop_zones_wrapper">
          <div id="drop_zone" class="">
            <p>DROP YOUR FILE(S) HERE</p><i>...or click to select</i>
          </div>
          <div id="spacer_cell"> </div>
          <div id="drop_zone_instant" class="">
            <p class="">DROP HERE FOR <br><i>EXPRESS CONVERSION </i></p>
          </div>
        </div>
        <ol id="playlist_ol"></ol>
      </div>

      <div id="settings_wrapper">
        <div>
          <label for="file_name">Custom file name:</label> <br>
          <input id="file_name" autocomplete="off" type="text" style="width: 18ch" placeholder="output_file_name">
          <span> .swap.3mf</span>
          <br><br>
          <input id="loops" autocomplete="off" type="number" min="1" max="9999" step="1" value="1">
          <label for="loops">Loop repeats</label>
          <details class="tool_info">
            <summary></summary>
            <p>This number defines how many times the entire
              queue will be reprinted.</p>
            <p> Example: Plate "A"
              is set to 3 repeats, plate "B" is set to 1
              repeat and the "Loop repeats" is set to 2.
              This will result in following printing order: </p>
            <p> A A A B A A A B .</p>
          </details>
          <!-- Extra Settings für X1/P1 -->

          <div id="x1p1-settings" class="hidden">
            <label>
              <input type="checkbox" id="opt_filament_purge_off">
              Turn off filament purge
              <details class="tool_info">
                <summary></summary>
                <p>Disable the filament purge sequence after the first plate.
                  This can speed up multi-plate jobs but might cause issues with prints using different materials.</p>
              </details>
            </label>
            <label>
              <input type="checkbox" id="opt_purge" autocomplete="off" checked />
              Hide nozzle load line in model
              <details class="tool_info">
                <summary></summary>
                <p>Activate this option to achieve the correct nozzle pressure when starting a new print. If
                  deactivated, this may cause slight under-extrusion at the bottom of the first object.</p>
              </details>
            </label>
            <label>
              <input type="checkbox" id="opt_bedlevel_cooling">
              Raise Bed Level for cooling
              <details class="tool_info">
                <summary></summary>
                <p>Activate this option to raise the bed to fan height for faster cooling. <b>Warning:</b> For large
                  prints the printer cover must be removed to avoid collision.</p>
              </details>
            </label>
            <div id="advanced-cooldown-settings">
              <label for="raisebed_offset_mm">Bed raise offset before push-out (mm)</label>
              <input id="raisebed_offset_mm" type="number" step="1" min="5" max="200" value="30">
              <details class="tool_info">
                <summary></summary>
                <p>Defines how much the bed is raised before performing the push-out sequence.</p>
              </details>

              <label for="cooldown_target_bed_temp">Cooldown target bed temperature (°C)</label>
              <input id="cooldown_target_bed_temp" type="number" step="1" min="15" max="35" value="23">
              <details class="tool_info">
                <summary></summary>
                <p>Specifies the bed temperature that should be reached before the push-out sequence.</p>
              </details>
              <label for="cooldown_max_time">Max cooldown time (min)</label>
              <input id="cooldown_max_time" type="number" step="1" min="5" max="120" value="40">
              <details class="tool_info">
                <summary></summary>
                <p>
                  Defines the maximum cooldown duration in minutes.
                  The app will insert repeated <code>M190</code> commands to wait for the bed
                  until this total time is reached. Default is 40 minutes.
                </p>
              </details>
            </div>
            <label>
              <input type="checkbox" id="opt_secure_pushoff" checked>
              Secure push‑off sequence
              <details class="tool_info">
                <summary></summary>
                <p>
                  When enabled, the app performs multiple controlled push‑offs at decreasing Z heights
                  before the final push at Z=1. This helps avoid collisions and smooths the ejection.
                </p>
              </details>
            </label>

            <label for="extra_pushoff_levels" id="extra_pushoff_levels_label">
              Additional push‑off levels
            </label>
            <input id="extra_pushoff_levels" type="number" step="1" min="1" max="10" value="2">
            <details class="tool_info" id="extra_pushoff_levels_help">
              <summary></summary>
              <p>
                Defines how the maximum Z height is divided. Example: if max Z is 10&nbsp;mm
                and you enter <b>2</b>, push‑offs occur around Z≈5 and the final one at Z=1.
                If you enter <b>5</b>, there will be 5 extra push‑offs, with the last always at Z=1.
                A value of <b>1</b> means only a final push at Z=1.
              </p>
            </details><label class="opt">
              <input type="checkbox" id="opt_override_metadata" checked>
              Override project &amp; filament settings
            </label>
            <details class="tool_info" id="opt_override_metadata_help">
              <summary></summary>
              <p>
                When <b>on</b>, the app regenerates
                the filament entries and material/printer settings. This is essential if you use new
                AMS slot assignments that weren’t present in the original G-code. When <b>off</b>,
                the original 3MF metadata is kept as-is; if you remap to AMS slots that weren’t
                originally defined, the printer or Studio may report a mismatch.
              </p>
            </details>
          </div>
        </div>
      </div>
    </div>
  </div>

  <input type="file" autocomplete="off" accept=".3mf, .gcode" id="file" class="hidden" name="file" multiple />

  <template id="list_item_prototype">
    <li class="list_item hidden">
      <button class="plate-remove">×</button>
      <div class="p_title">
        <span class="f_id"> some_id </span>
        <span class="f_name single-line"> some_file.3mf </span>
        <span class="p_name"> some_plate </span> <br>
      </div>

      <img class="p_icon" />
      <div class="p_info" title="Duration of the plate printing and number of repeats.">
        <span class="p_time"> [plate_time] </span>
        <input class="p_rep" type="number" min="0" max="9999" step="1" value="1">
      </div>
      <div class="p_filaments">
        <div class="p_filament_prototype">
          <div class="f_color"> </div> <br>
          <span>Slot</span> <span class="f_slot"> </span> <br>
          <span class="f_type"> </span> <br>
          <span class="f_used_g"> </span> <span>g</span> <br>
          <span class="f_used_m"> </span> <span>m</span>
        </div>
      </div>
      <div class="plate-x1p1-settings hidden">
        <div class="plate-x1p1-header">Objects on this plate</div>

        <label class="obj-count-label">
          <span>Number of objects:</span>
          <select class="obj-count" autocomplete="off">
            <option value="1" selected>1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </label>

        <div class="obj-coords"></div>
      </div>
    </li>
  </template>

  <div id="site-info">
    <div id="err"> </div>

    <p>Multiprinter Version V1.1</p>
    <p>Based on V00-24</p>

    <details>
      <summary> Download self-test 3MF file </summary>
      <br><a href="https://swaplist.app/dat/selftest_files/Selftes-BBS_SWAP-A1M_v02.3mf"><b>Bambu Studio </b> self-test
        file </a>
      <br><br><a href="https://swaplist.app/dat/selftest_files/Selftes-ORCA_SWAP-A1M_v02.3mf"><b>Orca Slicer </b>
        self-test file </a>
      <br>
    </details>
    <details>
      <summary>Data security</summary>
      <p>
        This app uses your browser as an environment and runs locally on your computer.
        This means none of your data is sent to our server or any third party cloud provider.
        You can even save this app as a web page and use it completely offline.
        This site also does not use cookies or store any personal information on your device.
      </p>
    </details>

    <details>
      <summary>Information about site operator</summary>
      <p>
        Novibar GmbH<br>
        Muehlenstr. 51<br>
        59348 Luedinghausen<br>
        Germany
      </p>
    </details>
  </div>
  </div>

  <script src="dist/bundle.js"></script>
</body>

</html>